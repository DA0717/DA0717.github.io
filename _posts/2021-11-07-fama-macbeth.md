---
layout: post
title: "Fama-Macbeth Regression"
category: Quant
tags:
  - Quant
  - Regression
  - CAPM
---



> 从 CAPM 到 Fama-Macbeth Regression. 从产生动机到回归本身，再到扩展。

##### 1. 关于CAPM 的一些补充

假设条件（部分的）：**投资者具有相同预期**（即为模型中的期望收益率），即有相同的投资行为。所有投资者对某一资产的期望收益率、标准差及证券之间的相关性有相同预期。

> 超额收益也叫风险溢价。即相对于无风险资产多出的收益。

CAPM 表示为：

$$
E(R_i) = R_f + \beta_i [E(R_i) - R_f]
$$

where $\beta_i$ 为第 $i$ 个资产的系统风险指数，表示**该资产的**系统性风险。模型含义：资产的期望收益率是其**系统性风险指数**的正线性函数。即 $\beta_i$ 越大，期望收益率越大。注意系统性风险指数是影响资产期望收益率。

> 注：在后面的多因子模型中可见，系统性风险指数是因子暴露，而市场风险溢价是因子——市场因子。

##### 2. 如何检验 CAPM?——两阶段回归法 two-pass regression

###### 2.1 估计每个资产的 $\hat{\beta}$ ——市场溢价因子的因子暴露

对于资产 $i$ 的系统性风险指数 $\hat \beta_i$，选取的数据为该资产的时间序列数据，利用简单的线性回归进行估计。

$$
r_{it} - r_{ft} = \alpha_i + \beta_i (r_{Mt} - r_{ft}) + e_{it}
$$

得到资产 $i$ 的 $\hat \beta_i$，即得到**风险暴露**。

> 1. 是否有一个假设条件，资产 $i$ 的系统性风险 $\beta_i$ 是不随时间变化的？——哈哈哈，我瞎写的一个假设恰好就是 Fama-Macbeth 要解决的问题。（2021.10.31）
> 2.  $\alpha_i$ 是什么东西？
> 3. 数据选取（例）：$r_{ft}$ 选取 90 天国债利率，$r_{Mt}$ 选取 S&P500 作为市场组合收益率，$r _ {it}$ 即为该资产的收益率。

通过组合得到**资产组合**的系统性风险 $\beta_p$ （$p$ stands for portfolio）。

$$
\beta_p = \sum_{i=1}^n w_i \beta_i
$$

这一步也说明，系统性风险是不可抵消的。

###### 2.2 横截面回归 cross sectional regression (CSR)

用某个截面的——多个资产组合的超额收益对组合的系统性风险进行回归，得到回归系数的估计 $\hat b_0$, $\hat b_1$。

> 说是截面，其实是把第一步的时序数据所在的时间段选中，计算组合各自的在时间序列方向上的平均收益率作为 $R_p$。
>
> （比如第一步估计资产 $i$ 的系统性风险 $\beta_i$ 时，选择该资产 5 年内的 60 个月度收益率 $R_{it}, t = 1, \cdots, 60$ ；则在第二步的回归中的样本 $i$ 的收益率为资产 $i$ 在该 5 年内60个月的平均收益率）。

$$
R_p = b_0 + b_1 \beta_p + \epsilon_i
$$

 检验以下假设是否满足如下：

1. $b_0 = R_f$ (当然也可以左边为 $R_p - R_f$ 检验 $b _ 0 = 0$)
2. $b_1 = R_M-R_f$ 即 $b_1$ 是否为该截面时刻的市场的超额风险。

上述两步回归也可推广到多因子模型当中。

##### 3. Fama-Macbeth regression

